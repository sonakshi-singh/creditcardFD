dataset=read.csv("creditcard.csv",header=TRUE)
dataset$Class=as.factor(dataset$Class)
summ=summary(dataset)
write.csv(summ,"summ.csv")
covar=cov(dataset)
write.csv(covar,"covar.csv")
corr=cor(dataset)
write.csv(corr,"corr.csv")
hist(dataset$Class,ylim=c(0,300000))
print(table(dataset$Class))
plot(dataset$Time,dataset$Amount,col=c("red","blue")[dataset$Class])
print(prop.table(table(dataset$Class))*100)
      library(caret)
      set.seed(1000)
      splitindex<-createDataPartition(dataset$Class,p=0.70,list=FALSE,times=1)
      trainsplit=dataset[splitindex,]
      testsplit=dataset[-splitindex,]
      print(prop.table(table(trainsplit$Class))*100)
      print(prop.table(table(testsplit$Class))*100)
      library(DMwR)
      sampdatatrain=SMOTE(Class~.,trainsplit,perc.over=100,perc.under=200)
      print(prop.table(table(sampdatatrain$Class))*100)
      sampdatashuffletrain=sampdatatrain[sample(nrow(sampdatatrain)),]
      library(e1071)
      svmalgo=svm(Class~.,data=trainsplit)
      presvm=predict(svmalgo,testsplit[,1:30])
      confusionMatrix(svmalgo$fitted,trainsplit$Class)
      confusionMatrix(presvm,testsplit$Class)
      library(mlearning)
      tunepar <- tune.svm(Class~., data = trainsplit, cost = 2^(-2:8), gamma = 2^(-5:3)) 